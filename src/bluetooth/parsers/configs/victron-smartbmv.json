{
  "manufacturerId": 737,
  "name": "Victron SmartBMV",
  "description": "Victron Energy SmartBMV Battery Monitor / Smart Shunt",
  "encryptionKey": null,
  "requiresEncryptionKey": true,
  "encryption": {
    "algorithm": "aes-128-ctr",
    "nonceOffset": 1,
    "dataOffset": 2
  },
  "formatField": {
    "offset": 0,
    "length": 1,
    "type": "uint8",
    "comment": "This is the record type byte (0x02 for battery monitor)"
  },
  "formats": [
    {
      "version": 16,
      "formatName": "victron/battery_monitor",
      "minLength": 8,
      "description": "SmartBMV-712 / Smart Shunt data format (newer models use record type 0x10)",
      "fields": [
        {
          "name": "voltage",
          "offset": 0,
          "length": 2,
          "type": "uint16",
          "endian": "LE",
          "scale": 0.01,
          "unit": "V"
        },
        {
          "name": "alarm",
          "offset": 2,
          "length": 2,
          "type": "uint16",
          "endian": "LE"
        },
        {
          "name": "current",
          "offset": 4,
          "length": 2,
          "type": "int16",
          "endian": "LE",
          "scale": 0.1,
          "unit": "A"
        },
        {
          "name": "timeRemaining",
          "offset": 8,
          "length": 2,
          "type": "uint16",
          "endian": "LE",
          "unit": "minutes"
        },
        {
          "name": "stateOfCharge",
          "offset": 10,
          "length": 2,
          "type": "uint16",
          "endian": "LE",
          "scale": 0.01,
          "unit": "%"
        },
        {
          "name": "consumedAh",
          "offset": 12,
          "length": 4,
          "type": "int32",
          "endian": "LE",
          "scale": 0.1,
          "unit": "Ah"
        },
        {
          "name": "starterVoltage",
          "offset": 16,
          "length": 2,
          "type": "uint16",
          "endian": "LE",
          "scale": 0.01,
          "unit": "V"
        }
      ]
    },
    {
      "version": 2,
      "formatName": "victron/battery_monitor",
      "minLength": 8,
      "description": "SmartBMV / Smart Shunt data format (older models use record type 0x02)",
      "fields": [
        {
          "name": "voltage",
          "offset": 0,
          "length": 2,
          "type": "uint16",
          "endian": "LE",
          "scale": 0.01,
          "unit": "V"
        },
        {
          "name": "alarm",
          "offset": 2,
          "length": 2,
          "type": "uint16",
          "endian": "LE"
        },
        {
          "name": "current",
          "offset": 4,
          "length": 2,
          "type": "int16",
          "endian": "LE",
          "scale": 0.1,
          "unit": "A"
        },
        {
          "name": "timeRemaining",
          "offset": 8,
          "length": 2,
          "type": "uint16",
          "endian": "LE",
          "unit": "minutes"
        },
        {
          "name": "stateOfCharge",
          "offset": 10,
          "length": 2,
          "type": "uint16",
          "endian": "LE",
          "scale": 0.01,
          "unit": "%"
        },
        {
          "name": "consumedAh",
          "offset": 12,
          "length": 4,
          "type": "int32",
          "endian": "LE",
          "scale": 0.1,
          "unit": "Ah"
        },
        {
          "name": "starterVoltage",
          "offset": 16,
          "length": 2,
          "type": "uint16",
          "endian": "LE",
          "scale": 0.01,
          "unit": "V"
        }
      ]
    }
  ],
  "notes": [
    "HOW TO GET YOUR ENCRYPTION KEY:",
    "",
    "1. Open Victron Connect app (iOS, Android, or macOS)",
    "2. Connect to your SmartBMV device",
    "3. Go to 'Product Info' or 'Settings'",
    "4. Look for 'Instant readout details",
    "5. Copy the 32-character hex encryption key (e.g., d020496a21cf5db1e5ad2c647d1ec72d)",
    "",
    "ADDING THE DEVICE:",
    "",
    "When you select this device in your app, you'll be prompted to enter",
    "the encryption key. The key will be stored in device metadata and used",
    "automatically to decrypt the battery data.",
    "",
    "DATA PROVIDED:",
    "- Battery voltage (main + starter)",
    "- Current (charging/discharging)",
    "- State of charge (%)",
    "- Time remaining",
    "- Consumed amp-hours",
    "- Alarm status"
  ]
}
